//
//  day.swift
//  AdventOfCode2020
//
//  Created by Morgan Kan on 29/11/2020.
//

// not proud of this one: wrestled with far too many annoyances, and then at the end ran into the size of the final map not fitting in 64-bit ints so I refactored to use the BitSet library I contributed to a couple years ago.
// Super hacky, and lots of ugly code. But I don't want to stare at this anymore today so this is where I left it. At least it works!

import Foundation

class Day20 : AoCDay {
    static let MAX_SIZE = 100
    
    struct Tile : CustomStringConvertible {
        let id : Int
        var sides : [BitSet]
        var tile : [BitSet]
        
        var top : BitSet {
            return sides[0]
        }
        var left : BitSet {
            return sides[1]
        }
        var right : BitSet {
            return sides[2]
        }
        var bottom : BitSet {
            return sides[3]
        }
        var setBits : Int {
            var count = 0
            for row in 0..<tile.count {
                for col in 0..<tile.count {
                    if (tile[row][col]) {
                        count += 1
                    }
                }
            }
            return count
        }
        
        var description: String {
            var str = "id: \(id)\n"
            for y in 0..<tile.count {
                for x in (0..<tile.count).reversed() {
                    if tile[y][x] {
                        str.append( "#" )
                    } else {
                        str.append( "." )
                    }
                }
                str.append( "\n" )
            }
            return str
        }
        
        init( id: Int, grid: [BitSet] ) {
            self.id = id
            self.tile = grid
            sides = [BitSet]()
            sides.append(grid[0])
            var left = BitSet(size: MAX_SIZE), right = BitSet(size: MAX_SIZE)
            for item in grid {
                right = right << 1
                if( item[0] ) {
                    right.set(0)
                }
                left = left << 1
                if( (item >> 9)[0] ) {
                    left.set(0)
                }
            }
            sides.append(left)
            sides.append(right)
            sides.append(grid.last!)
        }
        
        static func readTile( rows: ArraySlice<String> ) -> Tile {
            let idLine = rows.first!.components(separatedBy: CharacterSet( charactersIn: ": ") )
            var grid = [BitSet]() 
            for index in rows.startIndex+1..<rows.endIndex {
                var item = BitSet(size: MAX_SIZE)
                for char in rows[index] {
                    item = item << 1
                    if char == "#" {
                        item.set(0)
                    }
                }
                grid.append( item )
            }
            return Tile(id: Int(idLine[1])!, grid: grid)
        }
        
        mutating func rotateClockwise() {
            var newSides = [BitSet]()
            newSides.append( sideFlipped( self.left, tile.count ) )
            newSides.append( self.bottom )
            newSides.append( self.top )
            newSides.append( sideFlipped( self.right, tile.count ) )
            var newGrid = [BitSet]()
            for y in 0..<tile.count {
                var val = BitSet(size: MAX_SIZE)
                for x in 0..<tile.count {
                    val = val << 1
                    //print( "\(tile.count-x-1) , \(tile.count - y - 1)")
                    if (tile[tile.count-x-1][tile.count - y - 1]) {
                        val.set(0)
                    }
                }
                newGrid.append(val)
            }

            sides = newSides
            tile = newGrid
        }
        
        mutating func flipVertical() {
            var newSides = [BitSet]()
            newSides.append( self.bottom )
            newSides.append( sideFlipped( self.left, tile.count ) )
            newSides.append( sideFlipped( self.right, tile.count ) )
            newSides.append( self.top )
            var newGrid = [BitSet]()
            for y in 0..<tile.count {
                newGrid.append( tile[tile.count - y - 1] )
            }
            sides = newSides
            tile = newGrid
        }
        
        mutating func flipHorizontal() {
            var newSides = [BitSet]()
            newSides.append( sideFlipped( self.top, tile.count) )
            newSides.append( self.left )
            newSides.append( self.right )
            newSides.append( sideFlipped( self.bottom, tile.count ) )
            var newGrid = [BitSet]()
            for y in 0..<tile.count {
                newGrid.append( sideFlipped(tile[y], tile.count) )
            }
            sides = newSides
            tile = newGrid
        }
    }
    
    static func sideFlipped( _ side: BitSet, _ size: Int ) -> BitSet {
        var result = BitSet(size: MAX_SIZE)
        for i in 0..<size {
            if side[i] {
                result.set(size-i-1)
            }
        }
        return result
    }
    
    static func hasMatchingSides( tile1: Tile, tile2: Tile ) -> Bool {
        for side in tile1.sides {
            for side2 in tile2.sides {
                if side == side2 || side == sideFlipped(side2, tile1.tile.count) {
                    return true
                }
            }
        } 
        return false
    }
    
    func readInput( str : String ) -> [Int : Tile] {
        let items = str.components(separatedBy: "\n")
        
        var tiles = [Int : Tile]()
        var index = 0
        while index < items.count {
            let tile = Tile.readTile(rows: items[index..<index+11])
            tiles[tile.id] = tile
            index += 12
        }
        return tiles
    }
    
    static func findMatchingSides( tiles: [Int: Tile] ) -> [Int : Set<Int>] {
        var counts = [Int : Set<Int>]()
        for (_,tile1) in tiles {
            for (_,tile2) in tiles {
                if tile1.id == tile2.id {
                    continue
                }
                
                if( hasMatchingSides(tile1: tile1, tile2: tile2) ) {
                    if counts[tile1.id] == nil {
                        counts[tile1.id] = Set<Int>()
                    }
                    counts[tile1.id]!.insert( tile2.id )
                }
            }
        }
        return counts
    }
    
    func solvePuzzle( startingCorner: Int, matchResults : [Int : Set<Int>] ) -> [[Int]] {
        var usedPieces = [Int:Bool]()
        let puzzleSize = Int(sqrt(Double(matchResults.count)))
        var puzzle = Array(repeating: [Int](), count: puzzleSize)
        for i in 0..<puzzleSize {
            puzzle[i] = Array(repeating: 0, count: puzzleSize)
        }
        puzzle[0][0] = startingCorner
        usedPieces[startingCorner] = true
        
        for y in 1..<(puzzle.count * 2) {
            for x in 0...y {
                if y - x >= puzzle.count || x >= puzzle.count {
                    continue
                }
                var candidates = Set<Int>()
                if x == 0 {
                    candidates = matchResults[ puzzle[y-x-1][0] ]!
                } else if y-x == 0 {
                    candidates = matchResults[ puzzle[0][x-1] ]!
                } else {
                    //print( "\(puzzle[y-x][x-1]) \(puzzle[y-x-1][x])" )
                    candidates = matchResults[ puzzle[y-x][x-1] ]!.intersection( matchResults[ puzzle[y-x-1][x] ]! )
                }
                let filteredCandidates = candidates.filter( { usedPieces[$0] == nil} )
                
                let picked = filteredCandidates.min(by: {
                    matchResults[$0]!.count < matchResults[$1]!.count
                })!
                puzzle[y-x][x] = picked
                usedPieces[ picked ] = true
            }
        }
        
        return puzzle
    }
    
    static func findCommonSide( tile1 : Tile, tile2 : Tile ) -> (side1Ix: Int, side2Ix: Int, isFlipped: Bool) {
        for (side1Ix, side1) in tile1.sides.enumerated() {
            for (side2Ix, side2) in tile2.sides.enumerated() {
                if side1 == side2 {
                    return(side1Ix,side2Ix,false)
                } else if side1 == sideFlipped(side2, tile1.tile.count) {
                    return(side1Ix, side2Ix,true)
                }
            }
        }
        return (-1, -1, false)
    }
    
    static func orientPieces( grid: [[Int]], pieces: [Int: Tile] ) -> [[Tile]] {
        
        // fix top left piece first
        var topLeft = pieces[grid[0][0]]!
        let (rightSide,_,_) = findCommonSide(tile1: topLeft, tile2: pieces[grid[0][1]]! )
        print( rightSide )
        if rightSide == 0 {
            topLeft.rotateClockwise()
        } else if rightSide == 1 {
            topLeft.flipHorizontal()
        } else if rightSide == 3 {
            topLeft.rotateClockwise()
            topLeft.flipHorizontal()
        }
        
        let (bottomSide,_,_) = findCommonSide(tile1: topLeft, tile2: pieces[grid[1][0]]! )
        print( bottomSide )
        if( bottomSide == 0 ) {
            topLeft.flipVertical()
        }
        
        var result = [[Tile]]()
        for y in 0..<grid.count {
            var row = [Tile]()
            for x in 0..<grid.count {
                if x == 0, y == 0 {
                    row.append( topLeft )
                    continue
                }
                var currentTile = pieces[grid[y][x]]!
                if x == 0 {
                    var ( _, top, isFlipped) = findCommonSide(tile1: result[y-1][x], tile2: currentTile )
                    while( top != 0 ) {
                        currentTile.rotateClockwise()
                        ( _, top, isFlipped) = findCommonSide(tile1: result[y-1][x], tile2: currentTile )
                    }
                    if isFlipped {
                        currentTile.flipHorizontal()
                    }
                } else /*if y == 0*/ {
                    var ( _, left, isFlipped) = findCommonSide(tile1: row[x-1], tile2: currentTile )
                    while( left != 1 ) {
                        currentTile.rotateClockwise()
                        ( _, left, isFlipped ) = findCommonSide(tile1: row[x-1], tile2: currentTile )
                    }
                    if isFlipped {
                        currentTile.flipVertical()
                    }
                }
                row.append(currentTile)
            }
            result.append(row)
        }
        
        return result
    }
    
    static func mergeGrid( solvedPuzzle: [[Tile]] ) -> Tile {
        var newGrid = [BitSet]()
        let WIDTH = 8
        var mask = BitSet(size: MAX_SIZE)
        mask.set(8)
        mask = ~mask
        for tileRow in solvedPuzzle {
            var currentGridRow = BitSet(size: MAX_SIZE)
            for rowIndex in 1..<(tileRow[0].tile.count-1) {
                for tile in tileRow {
                    currentGridRow = currentGridRow << WIDTH
                    currentGridRow = currentGridRow | ((tile.tile[rowIndex] >> 1) & mask) // mask off first and last chars
                }
                newGrid.append( currentGridRow )
            }
        }
        return Tile(id: 0, grid: newGrid)
    }
    
    
    func findSeaMonster( pattern: [BitSet], patternWidth: Int, tile : Tile ) -> (Int, Tile) {
        var modTile = tile
        var found = 0 
        for row in 0...tile.tile.count - pattern.count {
            for col in 0...tile.tile.count - patternWidth {
                if ((pattern[0] << col) & tile.tile[row]) == (pattern[0] << col),
                   ((pattern[1] << col) & tile.tile[row+1]) == (pattern[1] << col),
                   ((pattern[2] << col) & tile.tile[row+2]) == (pattern[2] << col) {
                    found += 1
                    modTile.tile[row] = modTile.tile[row] & ~(pattern[0] << col)
                    modTile.tile[row+1] = modTile.tile[row+1] & ~(pattern[1] << col)
                    modTile.tile[row+2] = modTile.tile[row+2] & ~(pattern[2] << col)
                }
            }
        }
        return (found, modTile)
    }
 
    
    override func problem01()
    {
        let tiles = readInput(str: input)
        var result = 1
        let matchResults = Day20.findMatchingSides(tiles: tiles)
        var startingCorner = 0
        for (id, matches) in matchResults {
            if matches.count == 2 {
                print( id )
                if( startingCorner == 0 ) {
                    startingCorner = id
                }
                result *= id
            }
        }
        print( result )
        
        let puzzleGrid = solvePuzzle(startingCorner: startingCorner, matchResults: matchResults)
        
        let solved = Day20.orientPieces( grid: puzzleGrid, pieces: tiles )
        print( solved )
        var mergedGrid = Day20.mergeGrid( solvedPuzzle: solved )
        print( mergedGrid )
        mergedGrid.rotateClockwise()
        
// a sea monster
//                          # 
//        #    ##    ##    ###
//         #  #  #  #  #  #  
        
// with hex boundaries
//        |    |    |    |    |  # |
//        |#   | ## |   #|#   | ###|
//        | #  |#  #|  # | #  |#   |
        
        let seaMonsterPattern = [
            0x00002,
            0x86187,
            0x49248
        ]

        var seaMonsterBitset = Array(repeating: BitSet(size: Day20.MAX_SIZE), count: seaMonsterPattern.count)
        for x in 0..<seaMonsterPattern.count {
            for y in 0..<20 {
                if( seaMonsterPattern[x] & (1<<y) ) != 0 {
                    seaMonsterBitset[x].set(y)
                }
            }
        }
        
        var (numFound, maskedGrid) = findSeaMonster(pattern: seaMonsterBitset, patternWidth: 20, tile: mergedGrid)
        while( numFound == 0 ) {
            for _ in 1...4 {
                mergedGrid.rotateClockwise()
                (numFound, maskedGrid) = findSeaMonster(pattern: seaMonsterBitset, patternWidth: 20, tile: mergedGrid)
                if( numFound > 0 ) {
                    break
                }
            }
            if( numFound == 0 ) {
                mergedGrid.flipHorizontal()
            }
        }
        print( numFound )
        print( maskedGrid )
        print( maskedGrid.setBits )
    }
    
    let sampleInput = """
    Tile 2311:
    ..##.#..#.
    ##..#.....
    #...##..#.
    ####.#...#
    ##.##.###.
    ##...#.###
    .#.#.#..##
    ..#....#..
    ###...#.#.
    ..###..###

    Tile 1951:
    #.##...##.
    #.####...#
    .....#..##
    #...######
    .##.#....#
    .###.#####
    ###.##.##.
    .###....#.
    ..#.#..#.#
    #...##.#..

    Tile 1171:
    ####...##.
    #..##.#..#
    ##.#..#.#.
    .###.####.
    ..###.####
    .##....##.
    .#...####.
    #.##.####.
    ####..#...
    .....##...

    Tile 1427:
    ###.##.#..
    .#..#.##..
    .#.##.#..#
    #.#.#.##.#
    ....#...##
    ...##..##.
    ...#.#####
    .#.####.#.
    ..#..###.#
    ..##.#..#.

    Tile 1489:
    ##.#.#....
    ..##...#..
    .##..##...
    ..#...#...
    #####...#.
    #..#.#.#.#
    ...#.#.#..
    ##.#...##.
    ..##.##.##
    ###.##.#..

    Tile 2473:
    #....####.
    #..#.##...
    #.##..#...
    ######.#.#
    .#...#.#.#
    .#########
    .###.#..#.
    ########.#
    ##...##.#.
    ..###.#.#.

    Tile 2971:
    ..#.#....#
    #...###...
    #.#.###...
    ##.##..#..
    .#####..##
    .#..####.#
    #..#.#..#.
    ..####.###
    ..#.#.###.
    ...#.#.#.#

    Tile 2729:
    ...#.#.#.#
    ####.#....
    ..#.#.....
    ....#..#.#
    .##..##.#.
    .#.####...
    ####.#.#..
    ##.####...
    ##..#.##..
    #.##...##.

    Tile 3079:
    #.#.#####.
    .#..######
    ..#.......
    ######....
    ####.#..#.
    .#...#.##.
    #.#####.##
    ..#.###...
    ..#.......
    ..#.###...
    """
    
    let input = """
    Tile 2903:
    ..#..#....
    .....#...#
    ..#...#.##
    #....#..#.
    #.....#..#
    ........##
    ........#.
    #..##.....
    ##.......#
    ##.....##.

    Tile 3659:
    ###....##.
    ....#...#.
    ..........
    ......#...
    #.........
    ###.#.#...
    #....#...#
    #..#..#...
    ....#.....
    ..#.##..##

    Tile 3691:
    #..##...#.
    .........#
    ##.#.....#
    .#........
    .......#..
    ..........
    ##...#....
    ..........
    #...#..#..
    ###.#.#.##

    Tile 3391:
    .#####.##.
    #.....#.##
    ####......
    ...#.#..##
    .#.#.#....
    #.#......#
    #.......##
    .#...#...#
    #.##.....#
    ...#..#.#.

    Tile 1867:
    .##....#.#
    ........#.
    #...#....#
    ..........
    .........#
    .........#
    #.#.#.....
    #...#.#...
    ....#..#.#
    .##.##.###

    Tile 3259:
    #.......##
    ..#......#
    ###......#
    #......###
    ##.......#
    #..#.#.#.#
    #...#.##..
    ##........
    #....#....
    ....#...##

    Tile 2441:
    .#....#.#.
    ..#.......
    .#.......#
    #.#.#...#.
    #..#..#..#
    #.......#.
    .....###..
    ...#......
    .##....#..
    ####.##.#.

    Tile 2477:
    .#.###..#.
    ##......##
    #....#...#
    .#..#.....
    #..##..#..
    ...#.###..
    #.#.......
    #....##.##
    .....#....
    ####.#....

    Tile 3533:
    ....######
    #.#.....##
    #.#.....##
    ##.#...#..
    #..##..##.
    #.##.##...
    ..##.#...#
    .....#..#.
    ..........
    ...#.#.#.#

    Tile 3877:
    #.#.#####.
    .....#.##.
    ....###..#
    .....###..
    ...#..#..#
    #...#..#.#
    ....#....#
    .........#
    #...#...##
    ...#.#.##.

    Tile 3491:
    ####..#..#
    ..#...#...
    ...###....
    .#.......#
    #.......##
    .#..###...
    ...#.....#
    #....#...#
    ##.#..##..
    ###.##.#..

    Tile 2161:
    ##.#..####
    .#....#.##
    #..#.....#
    ..........
    #.......##
    #.#....#.#
    #.#..#.#..
    .....#..##
    #.#.#..#..
    #..###....

    Tile 3917:
    ##..#####.
    ##.......#
    #......#..
    .#....#..#
    #.#...#.##
    #......#.#
    #...#.##.#
    #........#
    ##..#.#...
    ...###....

    Tile 1063:
    ..#.#....#
    ##..#....#
    #....#..##
    #.#.......
    #..#..#...
    ...##..#.#
    ...#.#..#.
    #........#
    ..........
    #.#####.##

    Tile 1999:
    #....##.##
    #........#
    #.........
    .....#.#.#
    #...#....#
    .....#...#
    ...#.....#
    #........#
    #.........
    #.#####..#

    Tile 2473:
    #..#.#...#
    #..#....#.
    #....#....
    ..#.....#.
    #......#..
    .#..#....#
    ..#...#..#
    #...#.....
    ....#.....
    .##.#..###

    Tile 2861:
    .###....#.
    .#..#...##
    .###..#.##
    ###....##.
    ###.#.#..#
    ...#.....#
    #........#
    ...####...
    .##....#..
    ##.###....

    Tile 3449:
    ###.#.####
    #........#
    ##...#.#.#
    ...##..#.#
    #..#.....#
    #.........
    #.....#..#
    #.........
    #...#.....
    ..####...#

    Tile 3571:
    .##.##.#..
    ##....##..
    ###.......
    ##........
    #....##..#
    #..##..#..
    #..#.#..#.
    .....#..##
    .##.....##
    ##....####

    Tile 1987:
    ###.#..#..
    ..........
    #........#
    ..#.##..##
    ##.......#
    #........#
    #........#
    ......#...
    ..#.#....#
    #####.#...

    Tile 2309:
    .#...#....
    #.#.......
    ...#..#..#
    ..###.#..#
    .........#
    ..##.#...#
    ...###....
    #..#..#.##
    .#...#...#
    ..##..####

    Tile 2503:
    ..###.#.#.
    #......##.
    #......#..
    .#..###..#
    #........#
    .......#..
    ###....##.
    ##......#.
    ......#.#.
    #.#.#..#.#

    Tile 3821:
    .##.######
    #......#.#
    .#.#...##.
    #........#
    #...##..##
    ..#.#....#
    ........##
    #........#
    #...#..#.#
    .###.#.#.#

    Tile 2029:
    #####...##
    #..##.....
    ....#.#...
    ##.#####.#
    ...##.....
    #.........
    ##...#....
    ....#.....
    ....##....
    ####.#.#..

    Tile 2131:
    .#.#.###.#
    #....#....
    ..#..#...#
    ......#...
    #.........
    #.........
    ...#..#..#
    ....#.....
    .#..#...#.
    ..#.#..#.#

    Tile 3907:
    ..###.##..
    ...#.#.###
    .#.......#
    .#........
    #..###..#.
    .........#
    #.#.......
    .#....#.#.
    .#........
    ......#...

    Tile 2341:
    ..#..#.#..
    ....#.....
    #.#.##.###
    ##...###..
    ......##.#
    #.........
    ..#.......
    .....#....
    ..#.......
    ##.##.#..#

    Tile 3323:
    ...#....##
    ##...#...#
    #.......##
    ...#.....#
    #..#.....#
    #.......#.
    #...#....#
    #.........
    #...#....#
    #......#.#

    Tile 2311:
    .#..#....#
    .........#
    #.#.....#.
    ...#...#..
    ..####...#
    ..##......
    .....#....
    ..#..#....
    .#.#......
    .##...####

    Tile 1873:
    #####...#.
    ..###.....
    #.....#..#
    #..#....#.
    #.#.......
    #......###
    ......###.
    ...#.....#
    ##.......#
    ####.##.#.

    Tile 3229:
    .####..##.
    .#.....###
    .#.....#..
    ###.##..##
    #......##.
    ...#..#.##
    .........#
    .........#
    #......#.#
    .#.#.#..#.

    Tile 2753:
    ....######
    ##..#.....
    #.#....#.#
    ..........
    ......##..
    #...#.....
    #.......#.
    #.........
    ....#.....
    ###....#.#

    Tile 2179:
    .####..##.
    #.#.....##
    #......#.#
    .........#
    ...#......
    ...#.....#
    #.......##
    .....##...
    ..#...#..#
    ##.##..###

    Tile 3253:
    ##..#..##.
    #.......#.
    .......#.#
    #......#..
    .....#.#..
    ..#.##.#.#
    #.........
    #.....#..#
    #..#......
    .#.##.#...

    Tile 3167:
    ###..#..#.
    ..#.#...#.
    ##....#.#.
    .#.....##.
    #......#..
    ....#.#...
    #........#
    ..........
    #........#
    ...###...#

    Tile 1453:
    .#.#..###.
    #...#....#
    #.#....#..
    ...#.....#
    ..........
    #..###..##
    ##......##
    #....#.##.
    ...#.#.#.#
    ..#.#.##..

    Tile 2939:
    #.##.#.###
    #..#..#...
    #....##..#
    .#....#..#
    ...#...#.#
    #.#..##...
    #.#.#....#
    #......##.
    #.#....#..
    .###...##.

    Tile 2251:
    .##...####
    ...#.....#
    .##......#
    ....##...#
    ##...#....
    #.#..#...#
    .#.#.#...#
    .#.#......
    ###...#...
    ..#.#...#.

    Tile 1223:
    .#..#.#.##
    #...#.#...
    .#..#...##
    #..#......
    ##....#..#
    .#.......#
    ......#..#
    .......#..
    #.#.#....#
    #...#.#.##

    Tile 3527:
    #####.###.
    #....#....
    .##.#..#..
    #...###.##
    #...#.#..#
    #....#.#..
    ##..#.....
    #.........
    #.....##.#
    ........#.

    Tile 1019:
    ##......#.
    .........#
    ..###.....
    #.......##
    .##.#....#
    ..#.......
    ####..##..
    #.#...#...
    ..........
    .####.#.##

    Tile 1181:
    ..#.###...
    #.....#..#
    ...#.#...#
    ....##...#
    ......##..
    ....#.#..#
    #.....#...
    #.#..##...
    ##.#.#...#
    .###.....#

    Tile 1693:
    #..#.##...
    .#..###...
    #..#.#..#.
    ##.......#
    ##.......#
    #.........
    #..#.....#
    #....#...#
    ##......##
    ...#...##.

    Tile 2633:
    ##.###...#
    .#....##..
    ...#......
    .....###.#
    #.....##..
    #...#...#.
    .##...#.#.
    ..#.......
    .......#..
    .#.###...#

    Tile 1171:
    .###.###..
    ##.#......
    .##..#..##
    #.#......#
    .##......#
    .#....#..#
    .##.......
    ..#......#
    ##........
    #..#..#.##

    Tile 2551:
    ####.##.##
    .....#..##
    ..........
    ...#.....#
    ..........
    ..#.#....#
    .#........
    #..#..#...
    #..#...###
    ..####.###

    Tile 1669:
    ##.......#
    .#....#..#
    #...#.....
    #.....#..#
    .........#
    .#.......#
    ...#......
    ....#..#..
    ..........
    ##....###.

    Tile 3989:
    #.##.....#
    .#.#......
    #..#....#.
    .......#..
    .##......#
    .........#
    ......##.#
    .....#.##.
    #.........
    #.#...#..#

    Tile 1069:
    ###..##...
    ...#..##.#
    #......#..
    .....#...#
    ..........
    #.........
    #.....#.#.
    ......##.#
    .........#
    #.#...##..

    Tile 3779:
    ###..####.
    #..#.....#
    #.#..#.#.#
    ..#.......
    ..........
    #..#.#.###
    #.........
    ...#......
    #...#...#.
    #.###.#..#

    Tile 1823:
    #....#####
    #........#
    ##....#...
    .........#
    #..#.##..#
    #...#....#
    ##.......#
    #.##..#...
    #.........
    #.#.#....#

    Tile 3331:
    ..##.#.#.#
    .##.....##
    #..#...#.#
    .......#..
    ##....#..#
    .......#..
    #.#...#.##
    .#......##
    .....#.#.#
    ##.#..#..#

    Tile 2333:
    .#.####...
    .##.....#.
    .#........
    ....#.#...
    ......##..
    ....#...#.
    #.......#.
    .......#.#
    ......#..#
    .#...#.#.#

    Tile 2137:
    .#.##.#...
    ...#..#..#
    ......#..#
    ...#.##..#
    #..#..#..#
    ........#.
    ..##.#....
    ....#....#
    .....##.#.
    ..###....#

    Tile 2837:
    ###.#.#.#.
    ..........
    ....#.....
    #...##....
    ......#...
    #.##.#....
    ..#...##..
    ...#....#.
    ##...#....
    ##...#####

    Tile 1619:
    .#.#..##.#
    #........#
    ..#.#.....
    ..#....##.
    ##...#..##
    ..#......#
    ....#...##
    #..#......
    #.#......#
    #.#..#....

    Tile 2693:
    ....#...#.
    #.........
    ..#.....#.
    ....#..#..
    ...##....#
    #.......#.
    ##.......#
    ........#.
    .#..#..#..
    ##.##..#..

    Tile 3613:
    ..#...#...
    .....##...
    .......#..
    .##.#..#..
    #....#....
    ...#....##
    #.#...####
    ...#......
    #....#....
    .##..#....

    Tile 1487:
    .#.#.###..
    .##.......
    ..##...#.#
    .#.......#
    #.........
    ..#......#
    ###.....#.
    .#.#.##...
    #.##.###.#
    ..#.####.#

    Tile 3583:
    ###.#.#.##
    ##........
    #........#
    ...#....#.
    #...#....#
    #..#...#..
    #..#......
    ##.#.....#
    ##.....#..
    #.#.#.....

    Tile 3607:
    ##..##..#.
    .#.##.....
    ......#...
    .....#...#
    #...##...#
    ...#..#.##
    #....###..
    .........#
    ...#....#.
    .....#...#

    Tile 1381:
    #..#.#####
    #.#...#..#
    ......##..
    #...#.....
    #.#.....#.
    #.........
    ....##...#
    .##...#...
    #..#..##.#
    #...##.##.

    Tile 2857:
    ..#.##.##.
    .#..#.##.#
    .#......#.
    ....#.....
    ##...##.#.
    #..##.#..#
    #.######..
    ...#.##..#
    #..#......
    .....#..#.

    Tile 2203:
    .####.#...
    #........#
    .#......#.
    #.....#...
    #..#.....#
    ##..##...#
    .....#...#
    ...#...##.
    ..........
    #.##......

    Tile 2383:
    .##.#....#
    #.....##.#
    ##........
    #......#..
    #.........
    ..#....#.#
    #....##...
    .......#..
    #.....#...
    ##.#.#..##

    Tile 3617:
    ..#.....#.
    #.#..#....
    ...#..####
    #..##..#.#
    #.#.#....#
    .#...##.#.
    ....##.#.#
    ..#....#.#
    #..#...#..
    #.####.#..

    Tile 3257:
    .#.##..#..
    ..........
    ...#.##.#.
    #........#
    #..#......
    .........#
    #.........
    ##.......#
    .....#...#
    ####.###..

    Tile 1979:
    .#..#.####
    #...##...#
    #.........
    ..........
    #.........
    ..#...#..#
    ....#..#..
    ..........
    .##......#
    #..#..#...

    Tile 3539:
    #..#..#.#.
    ###...#..#
    ##........
    .##...#..#
    #.#..#.##.
    #.........
    .#.....#..
    .#...#.#..
    ...#..#...
    #...#.##..

    Tile 3547:
    ..#.#.##..
    .......#..
    ##........
    ..#...###.
    .#....#..#
    .....####.
    #......###
    .#.....###
    .......#.#
    #..#..##.#

    Tile 3889:
    #..###.#.#
    #..#.....#
    .........#
    .#.#.....#
    .....#..##
    .#..##.#..
    ##..#....#
    ......##..
    #...#..#.#
    #.#..###..

    Tile 2221:
    .....#..#.
    ..#.....##
    ...#..#.#.
    .#...#...#
    ##.#..#.#.
    #..#.....#
    .........#
    #........#
    .#.#..#...
    ...###.###

    Tile 2237:
    ###...####
    #........#
    #........#
    #......##.
    .........#
    .....###.#
    ....#.....
    #.#..#....
    ....#....#
    .###.#.#.#

    Tile 1723:
    .#####....
    #.##...#.#
    ##.......#
    ....#....#
    #.........
    #..#.#....
    #.....#...
    .#...#...#
    .....#...#
    #....#..##

    Tile 3191:
    ####.####.
    #.#..#...#
    ##.#......
    .....#....
    #........#
    .#....#..#
    .....#...#
    ...###...#
    #.#..#..##
    ##...###.#

    Tile 1033:
    .#..#.#.##
    ..#...#.#.
    #........#
    #..#..#.#.
    .........#
    .........#
    #.......##
    #.....#..#
    #.....#.##
    #...#...##

    Tile 1471:
    ##.###..##
    ##.#...#..
    #........#
    .........#
    .##.......
    ...#..#.#.
    ..##.....#
    #.##...#..
    #......#.#
    ..##....#.

    Tile 1663:
    #..#.###.#
    ...#..#...
    ##........
    #.#......#
    #......#..
    ##...#...#
    #...#.#..#
    ...#.....#
    ......#...
    .#..#.##..

    Tile 2791:
    ...#.##.##
    ##.....##.
    .......#..
    .....#....
    #..#.....#
    #.#.......
    #........#
    ..##..#..#
    ##..#....#
    ##.####..#

    Tile 2411:
    ###.#...##
    #...#....#
    ##...#..#.
    #....#.#..
    ....#.###.
    .#....##..
    .........#
    .#..#.....
    .#...##.#.
    .#.#..#...

    Tile 2293:
    ....##.#..
    ###....#.#
    ###.......
    ...##.....
    #...#...#.
    .........#
    #...#....#
    #........#
    .......#.#
    .##...#.#.

    Tile 3847:
    #....####.
    ....##....
    #.......#.
    ..#.......
    ......#..#
    ##.....#..
    ..#...##..
    .........#
    #...##...#
    .####...##

    Tile 2917:
    ..##.##..#
    ....#.#..#
    ....#..#.#
    ...#.....#
    ..........
    ......#...
    ..........
    ##.......#
    #..##..##.
    ...#.##..#

    Tile 3079:
    ####.##.##
    ....#.##..
    #.......#.
    ..........
    #..#......
    .........#
    ......####
    #.........
    ....#.#.##
    .#..##.#..

    Tile 2699:
    .#.....##.
    #.###....#
    .#.##...#.
    .......#.#
    #.........
    #.........
    ..##.#..##
    #...#.#..#
    ....#....#
    #...#....#

    Tile 3581:
    ......##.#
    #....#..##
    #.....#..#
    ..#..##...
    .........#
    ...#.....#
    #.........
    ..........
    ...##....#
    .####.###.

    Tile 3359:
    ...##..##.
    ........#.
    ##.##....#
    .###.#..#.
    #.........
    #...#....#
    #....#...#
    #...#.....
    #...##.#..
    ..####.##.

    Tile 2579:
    ...#..#..#
    ..#......#
    ..#.#...##
    ##.......#
    #..#..#..#
    ###.#...##
    .##..##...
    ..#..#...#
    #.#.......
    ####..#.##

    Tile 2141:
    ##..#..##.
    ....#.....
    ..###..##.
    ..#.......
    ....#.....
    #.......#.
    #....#...#
    ...#......
    ...#.##.##
    ###.#.#.#.

    Tile 3863:
    .#..##.##.
    #.........
    ...#.....#
    .......###
    ...#......
    .......###
    #....#...#
    #.........
    #..#...##.
    ###...#.#.

    Tile 3373:
    #.##..####
    .........#
    #....#.##.
    #...##..##
    ##....#..#
    ####......
    ....#.....
    #..#.....#
    #...##.##.
    ...####.#.

    Tile 3299:
    ...#..##..
    #.#.#...#.
    ...###....
    #.#.##.#.#
    ........##
    .....#....
    ....#.....
    ...##....#
    .....#...#
    #...#.#...

    Tile 3559:
    .#.#.#####
    #.........
    #..#......
    #........#
    #.........
    #.......##
    .......#..
    ..#.#.....
    #......#..
    .###..#.##

    Tile 2273:
    #.#.##.#..
    #........#
    ##.##.#.#.
    ..#....##.
    ..#....#..
    #.....#.#.
    ....#.....
    #.........
    #.....#...
    #.#.#..##.

    Tile 1493:
    ......#.##
    ####...#.#
    ....#.#...
    .#...#....
    ..#..#...#
    ....#....#
    #.#...#..#
    #..#.....#
    ....#.....
    ..#.#.####

    Tile 2729:
    #.#.#.##..
    ##.##..#..
    .#.#......
    ..##....##
    #...#.....
    #.#.......
    #........#
    #........#
    #...##.#.#
    .#..#...#.

    Tile 3727:
    .##.#.#.##
    #..#..#..#
    ..#.##....
    #......#.#
    .....#....
    ..#.......
    ..##......
    .......#..
    ..#......#
    #...##..##

    Tile 2713:
    .....#.##.
    ##....##.#
    .##..#...#
    #.........
    .......##.
    ...#...#.#
    #.#..#...#
    #......##.
    #....#.#..
    ..#......#

    Tile 2269:
    #..#...#..
    ...#...#.#
    ...#.....#
    #..#....##
    #..#......
    #.....#...
    .#....#...
    #.#..#.#.#
    #.#.......
    ##....###.

    Tile 1811:
    .....#.##.
    ##........
    .#....##.#
    ....##...#
    .........#
    .....#...#
    #...#.#...
    ..........
    ..........
    ..#.###...

    Tile 1997:
    ###...###.
    ...#..#..#
    #....##...
    .....#...#
    ##..#....#
    #..##.....
    #.........
    ##...#....
    #.#.###...
    ..##..#...

    Tile 3637:
    ...#...#..
    #....#....
    #.........
    ..#...#..#
    #....#...#
    #.......#.
    #.........
    #.#.....#.
    ...#..#...
    ..###.####

    Tile 1151:
    #..#######
    #........#
    #.....#..#
    #....##..#
    .......#.#
    ........##
    ..#...#..#
    ..........
    #........#
    ###....#.#

    Tile 3467:
    ...##.##.#
    #.###.....
    .........#
    .....#..#.
    ..........
    .......#.#
    ##...#.#..
    .....##..#
    ###.#..#..
    #..#..##.#

    Tile 3457:
    .#..##..##
    #.#.......
    .......#..
    ...#...#..
    ........##
    #...######
    ..#.......
    ....#.....
    #...#..#.#
    ...#.#####

    Tile 1459:
    .##.####.#
    ....#.....
    #...##...#
    #.....#...
    .#....##..
    #...#..#.#
    ..#..#....
    ..........
    .#.#....##
    ..#.#.#..#

    Tile 1597:
    #.#.#.#...
    #......#.#
    #..#..#...
    #.....#..#
    ..###..#.#
    #.........
    ....#.....
    .#.....#..
    #...#.#.#.
    ##.#.#.##.

    Tile 3461:
    ..#...###.
    ......#...
    ...#.....#
    #....##..#
    #......#.#
    #...#.....
    ..#..##...
    ##..#..#.#
    #....#...#
    ...#....#.

    Tile 3803:
    .#.....##.
    ##..#....#
    #...##....
    ...##.....
    .........#
    #...#.....
    ........#.
    ##...##..#
    .....####.
    .#.#...#.#

    Tile 1153:
    .....#....
    #......#.#
    ..#..#....
    ......#.#.
    #......#.#
    #........#
    ##.#.....#
    ###...##.#
    #..#..#.##
    #.##....#.

    Tile 2083:
    .##....#.#
    ........##
    #.........
    #.#.#.##..
    .#........
    #........#
    #...##....
    ......##..
    #........#
    .#.#.##...

    Tile 1201:
    #.#.#.#.##
    ##.#.##.#.
    .......#.#
    #........#
    #....##..#
    ..#...#.#.
    #......###
    .##...#.##
    ...#.#.#..
    ..###.###.

    Tile 1091:
    ###.#....#
    .........#
    #..#...#..
    #........#
    #.#..#.#..
    #.....#.##
    ....#.##.#
    ......#...
    #...##..#.
    .#...#####

    Tile 3739:
    ####.##...
    .........#
    .#.#.....#
    #....#...#
    #....#...#
    ##.......#
    ..#......#
    #...#.....
    ##........
    .##..###.#

    Tile 2999:
    ...##.#.#.
    .#......#.
    .....#...#
    ##....#..#
    #......#.#
    #..#..#..#
    ...#.....#
    ........##
    #......###
    ###..#...#

    Tile 2393:
    ..##.#.###
    ........#.
    #........#
    ##.#..#...
    ..........
    .....#....
    .....#.#.#
    ##....#...
    ......#..#
    ###.##....

    Tile 2543:
    ####.#.#.#
    ......##.#
    ..........
    #......#..
    .#.......#
    ..#....#.#
    #.........
    #...#.#..#
    ...#......
    .#..#.####

    Tile 2677:
    #.###.#.##
    .....#.#.#
    #..#......
    ...##....#
    .#......##
    #........#
    .##..#....
    ..........
    #........#
    #.#.####..

    Tile 1229:
    ....###.#.
    #........#
    #........#
    ##..#.....
    #...#....#
    .#...#.#..
    .#...#...#
    ....#..###
    ........#.
    ###.#.##..

    Tile 3631:
    #.#...#.##
    #...##....
    #.#.......
    ##..#.....
    ..........
    ....#....#
    #.....#..#
    ##....#..#
    .....#...#
    #.###.#.##

    Tile 2909:
    .###.####.
    ..........
    ...#......
    #.........
    #..#..#..#
    ......#...
    #.#.......
    ###.#.....
    .#.##....#
    ..#..##..#

    Tile 2207:
    ##.##.##..
    .........#
    ..........
    ..#.##..#.
    .#.#.#####
    ..#....#.#
    #........#
    #.....#...
    #....#....
    ...##.###.

    Tile 1327:
    #...##.##.
    #.........
    ......#..#
    .#.......#
    #.....#.#.
    #.....#.##
    #....#...#
    ..#......#
    #.....#...
    .####.##.#

    Tile 2351:
    #######..#
    #........#
    ......#...
    ......##..
    #.#.....#.
    #....#...#
    ....#....#
    #........#
    #.......##
    ####..#.#.

    Tile 1213:
    ..#...####
    #..##....#
    #.#..#..##
    #..##...#.
    #...#.##.#
    #...#.....
    .......#.#
    #........#
    ##.#....#.
    .###.##.##

    Tile 1667:
    #...######
    #..##.#...
    #...#..#.#
    #.#....#..
    ##........
    .....#....
    ....#.....
    ###...#...
    #...#....#
    ...###.###

    Tile 2153:
    #..###...#
    ##....####
    .#.....###
    .#......#.
    #.#......#
    ....##...#
    ....#.#.##
    ...#...##.
    #...##.##.
    .#....#.##

    Tile 1483:
    .##.......
    .......##.
    #.#.###...
    .....#....
    ##.......#
    ...##....#
    #.#.....##
    #.........
    #..#......
    ....##..##

    Tile 1877:
    .###.#####
    #..##.#..#
    ###.#....#
    ...#..#..#
    ...##.#...
    .#.####..#
    ###.......
    ......#.##
    .......#.#
    #..#.###..

    Tile 1777:
    ###...####
    .....#....
    ###..#....
    #....#.#..
    #.....#...
    ...#..#.##
    ####......
    ..#.......
    .#.#......
    .###.##..#

    Tile 1433:
    #.#####..#
    ##.#......
    ##..#..##.
    ..#.....#.
    #...##....
    #.#...#.##
    ##.#.....#
    ##.#.....#
    .#.##.#...
    ####.####.

    Tile 1321:
    #.#.###...
    #...#....#
    #.#..#...#
    ....#....#
    ..........
    .......#..
    .#...#.#.#
    .#..#.#.#.
    ..#.##....
    ..##.#....

    Tile 2111:
    .#...##.#.
    #.#.......
    .......###
    #..#.#....
    ......#..#
    #.....#.#.
    #........#
    ..#..#.#.#
    #....##..#
    ..#....##.

    Tile 1973:
    #..#.....#
    #..#.....#
    .........#
    .....#..#.
    #......#.#
    ..#......#
    #....#....
    #.#.....#.
    .........#
    ###...#.#.

    Tile 3919:
    ..##.#..##
    #......##.
    .....###..
    #....#....
    #..###..##
    ###..##.#.
    ..#.#.#..#
    ..........
    #.###..#.#
    ....##..##

    Tile 1237:
    #.#.#...#.
    ..........
    ..##......
    ..##.#.#.#
    #......###
    ..........
    ...#......
    ..#.#.....
    ..#.#.....
    ..#..##...

    Tile 2803:
    ###.#....#
    .#........
    #....#....
    ......###.
    .....##...
    #.........
    ...#...#..
    .#........
    ....##....
    #..#..#.#.

    Tile 1559:
    .#...#..##
    #.........
    ....##...#
    #...#.....
    #......#..
    ........##
    .....#.#..
    #.....#..#
    ...#......
    ..#.......

    Tile 3083:
    .##..#####
    #....#....
    ...#......
    .#.......#
    .##...#..#
    #.#.......
    #.#..#....
    #......#.#
    #.........
    ..#..#....

    Tile 1549:
    ..#.##..##
    ......#..#
    ..#.......
    #...#.....
    #....#.#.#
    #.......#.
    .###.....#
    .##...#.#.
    ....#.#...
    .##.#..###

    Tile 2777:
    #...#.##.#
    ..........
    ....#.....
    ...#.##..#
    .#..#....#
    ..........
    .........#
    #......#..
    .#..#.#.#.
    .#...##.#.

    Tile 1621:
    #####.#.##
    #......#.#
    ..#.#...##
    ...##..#..
    ....#.....
    ##.#.#....
    #........#
    #.#...##..
    .....##...
    ###...##.#

    Tile 1847:
    ......####
    ####.#..#.
    .........#
    .#......##
    ##...#...#
    ..##..##.#
    #...#.....
    .....#...#
    #...#....#
    ..#.##.#.#

    Tile 1759:
    ##..#.####
    .#..##.##.
    ##.#..#.##
    ..#.....##
    .###..#...
    ###....##.
    #.#.##....
    ##.....#.#
    ...#.....#
    .#....##.#

    """
}
